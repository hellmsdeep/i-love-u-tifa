<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pedido especial</title>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@600&family=Inter:wght@300;600;800&display=swap" rel="stylesheet">
  <style>
    :root{--purple:#7c3aed;--purple-2:#9f7bff;--accent:#ff4d6d}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter,system-ui,Arial;background:#000}
    body{display:flex;align-items:center;justify-content:center;overflow:hidden}

    .stage{position:fixed;inset:0;background-image:url('https://i.pinimg.com/736x/ea/58/b9/ea58b92372ca0cd6d366aa2984765096.jpg');background-size:cover;background-position:center center;filter:contrast(1.04) saturate(1.03)}
    .stage::after{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.04),rgba(0,0,0,.08))}

    .wrap{position:relative;z-index:2;width:100%;max-width:820px;margin:28px;padding:22px;border-radius:14px;background:rgba(0,0,0,0.06);backdrop-filter:blur(2px)}
    h1{font-family:Cinzel,serif;margin:0;font-size:28px;text-align:center;color:#fff;text-shadow:0 6px 18px rgba(0,0,0,.6)}
    .question{margin-top:8px;text-align:center;font-size:16px;color:rgba(255,255,255,.96);font-weight:600}

    .controls{margin-top:18px;display:flex;justify-content:center}
    .frame{width:320px;border-radius:12px;padding:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);position:relative}

    .btn{display:block;width:100%;padding:10px 0;border-radius:10px;border:0;font-size:18px;font-weight:800;cursor:pointer;transition:transform .12s ease,box-shadow .12s ease;position:absolute;left:0}
    #yes{top:10px;background:linear-gradient(135deg,var(--purple),var(--purple-2));color:#fff;box-shadow:0 18px 50px rgba(124,58,237,.22)}
    #yes:active{transform:translateY(1px)}
    #no{top:86px;background:rgba(255,255,255,0.04);color:#fff;border:2px solid rgba(255,255,255,0.06)}

    .effects{position:fixed;inset:0;pointer-events:none;z-index:40}
    .heart{position:absolute;width:14px;height:14px;transform:rotate(-45deg);will-change:transform,opacity}
    .heart:before,.heart:after{content:'';position:absolute;width:14px;height:14px;border-radius:50%;background:linear-gradient(180deg,#ff9aa2,#ff4d6d)}
    .conf{position:absolute;width:10px;height:12px;border-radius:3px;will-change:transform,opacity}

    .overlay-modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0.6);opacity:0;pointer-events:none;transition:opacity .28s}
    .overlay-modal.show{opacity:1;pointer-events:auto}
    .modal{padding:18px 20px;border-radius:12px;background:rgba(0,0,0,0.75);text-align:center;border:1px solid rgba(255,255,255,0.04)}
    .modal p{margin:0;font-size:20px;color:#fff}

    .toast{position:absolute;left:50%;transform:translateX(-50%) translateY(-8px);top:-38px;padding:8px 12px;border-radius:8px;background:rgba(0,0,0,0.7);color:#fff;font-weight:700;font-size:13px;opacity:0;pointer-events:none;transition:opacity .18s,transform .18s}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(-14px)}

    .shake{animation:shakeAnim .42s ease-in-out}
    @keyframes shakeAnim{0%{transform:translateX(0)}25%{transform:translateX(-6px)}50%{transform:translateX(6px)}75%{transform:translateX(-4px)}100%{transform:translateX(0)}}

    @media(max-width:520px){.frame{width:86vw;padding:10px}.wrap{padding:16px;border-radius:12px}h1{font-size:22px}.question{font-size:15px}}
  </style>
</head>
<body>
  <div class="stage" id="stage" aria-hidden="true"></div>

  <div class="wrap" role="main">
    <h1>Pedido especial</h1>
    <div class="question">Tifa, <strong>você aceita namorar comigo?</strong></div>
    <div class="controls">
      <div class="frame" id="frame">
        <button id="yes" class="btn" aria-label="Sim" tabindex="0">SIM</button>
        <button id="no" class="btn" aria-label="Não" tabindex="0">NÃO</button>
        <div class="toast" id="noToast">pensa melhor</div>
      </div>
    </div>
  </div>

  <div class="overlay-modal" id="overlayModal" aria-hidden="true">
    <div class="modal" role="dialog" aria-modal="true">
      <p id="loveText">ebaeba eu te amo</p>
    </div>
  </div>

  <div class="effects" id="effects"></div>

  <audio id="audio" preload="auto" loop playsinline>
    <source src="sienna.mp3" type="audio/mpeg">
  </audio>

  <script>
    const stage = document.getElementById('stage');
    const yes = document.getElementById('yes');
    const no = document.getElementById('no');
    const frame = document.getElementById('frame');
    const effects = document.getElementById('effects');
    const overlayModal = document.getElementById('overlayModal');
    const audio = document.getElementById('audio');
    const noToast = document.getElementById('noToast');

    let unlocked = false;
    let started = false;
    let noFirst = true;

    function parallax(e){
      const client = e.touches && e.touches[0] ? e.touches[0] : e;
      const rx = (client.clientX / window.innerWidth - 0.5) * 6;
      const ry = (client.clientY / window.innerHeight - 0.5) * 4;
      stage.style.transform = `translate3d(${rx}px, ${ry}px, 0) scale(1.01)`;
    }
    window.addEventListener('mousemove', parallax);
    window.addEventListener('touchmove', (e)=>{ if(e.touches && e.touches[0]) parallax(e.touches[0]); }, {passive:true});

    function placeButtons(){
      const gap = 12;
      yes.style.width = '100%';
      no.style.width = '100%';
      yes.style.top = gap + 'px';
      no.style.top = (yes.offsetHeight + gap*2) + 'px';
      const needed = parseInt(no.style.top) + no.offsetHeight + gap;
      if(frame.clientHeight < needed) frame.style.height = needed + 'px';
      // position toast centered above NO
      const rect = no.getBoundingClientRect();
      const parentRect = frame.getBoundingClientRect();
      noToast.style.left = (rect.left - parentRect.left + rect.width/2) + 'px';
      noToast.style.top = (rect.top - parentRect.top - 38) + 'px';
    }

    function spawnHearts(cx, cy, count){
      for(let i=0;i<count;i++){
        const h = document.createElement('div'); h.className='heart'; effects.appendChild(h);
        const sx = cx + (Math.random()*80 - 40);
        const sy = cy + (Math.random()*20 - 10);
        h.style.left = sx + 'px';
        h.style.top = sy + 'px';
        const driftX = (Math.random()*220 - 110);
        const dur = 1200 + Math.random()*1400;
        h.animate([{transform:'translate3d(0,0,0) scale(.9)',opacity:1},{transform:`translate3d(${driftX}px,-160%,0) scale(1.15)`,opacity:0}],{duration:dur,easing:'cubic-bezier(.2,.8,.2,1)'}).onfinish = ()=>h.remove();
      }
    }

    function spawnConfetti(cx, cy, n){
      const colors=['#7c3aed','#9f7bff','#ff4d6d','#ffd166','#7bdff2'];
      for(let i=0;i<n;i++){
        const c = document.createElement('div'); c.className='conf'; c.style.background = colors[Math.floor(Math.random()*colors.length)]; effects.appendChild(c);
        c.style.left = (cx + (Math.random()*140 - 70)) + 'px'; c.style.top = cy + 'px';
        const rot = Math.random()*360; const dur = 1600 + Math.random()*1800;
        c.animate([{transform:`translateY(0) rotate(${rot}deg)`,opacity:1},{transform:`translateY(120vh) rotate(${rot+720}deg)`,opacity:0}],{duration:dur,easing:'cubic-bezier(.2,.6,.2,1)'}).onfinish = ()=>c.remove();
      }
    }

    function showLove(){ overlayModal.classList.add('show'); overlayModal.setAttribute('aria-hidden','false'); }

    async function playAudioWithFallback(){
      try{ audio.currentTime = 0; audio.volume = 1.0; await audio.play(); return true; }catch(err){
        try{ audio.muted = true; await audio.play(); audio.muted = false; return true; }catch(e){ loadYouTubeFallback(); return false; }
      }
    }

    async function celebrate(){
      if(started) return; started = true;
      const rect = yes.getBoundingClientRect();
      const cx = rect.left + rect.width/2; const cy = rect.top + rect.height/2;
      spawnHearts(cx, cy, 64); spawnConfetti(cx, cy, 80);
      setTimeout(()=>spawnHearts(cx, cy, 40), 240); setTimeout(()=>spawnConfetti(cx, cy, 40), 480);
      showLove(); await playAudioWithFallback();
    }

    function unlockAudioOnce(){ if(unlocked) return; unlocked = true; audio.muted = true; audio.play().then(()=>{ setTimeout(()=>{ audio.muted = false; }, 200); }).catch(()=>{}); document.removeEventListener('pointerdown', unlockAudioOnce); }
    document.addEventListener('pointerdown', unlockAudioOnce, {passive:true});

    yes.addEventListener('pointerdown', (e)=>{ e.preventDefault(); celebrate(); });
    yes.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); celebrate(); } });

    // NO is static but clickable — first click shows 'pensa melhor'
    no.addEventListener('click', (e)=>{ e.preventDefault(); if(noFirst){ noFirst = false; noToast.classList.add('show'); setTimeout(()=>noToast.classList.remove('show'),1200); } else { no.classList.add('shake'); setTimeout(()=>no.classList.remove('shake'),420); } });
    no.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' ') { e.preventDefault(); no.click(); } });

    window.addEventListener('load', ()=>{ placeButtons(); setTimeout(()=>{},120); });
    window.addEventListener('resize', ()=>{ placeButtons(); });

    let ytLoaded=false;
    function loadYouTubeFallback(){ if(ytLoaded) return; ytLoaded=true; const tag=document.createElement('script'); tag.src='https://www.youtube.com/iframe_api'; document.body.appendChild(tag); window.onYouTubeIframeAPIReady=function(){ const player=new YT.Player(document.createElement('div'),{height:'0',width:'0',videoId:'1rZJwZC9C3s',playerVars:{autoplay:1,controls:0,loop:1,playlist:'1rZJwZC9C3s',playsinline:1,modestbranding:1,rel:0},events:{onReady:function(e){ try{ e.target.mute(); e.target.playVideo(); setTimeout(()=>{ try{ e.target.unMute(); }catch(_){} },700); }catch(_){} }}}); player.getIframe().style.display='none'; document.body.appendChild(player.getIframe()); }; }

  </script>
</body>
</html>
